<!-- Auto-build slideshow from /img/photos/*.{jpg,jpeg,png} -->
<section id="slideshow" aria-label="Chapter photo slideshow">
  <div class="slideshow-container">
    {% assign photos = site.static_files
       | where_exp: "f", "f.path contains '/img/photos/'"
       | where_exp: "f", "f.extname == '.jpg' or f.extname == '.jpeg' or f.extname == '.png'" 
    %}
    {% assign photos = photos | sort: "name" %}

    {% for f in photos %}
      <div class="slides fade" {% unless forloop.first %}style="display:none"{% endunless %}>
        <img src="{{ f.path | relative_url }}" alt="Chapter photo {{ forloop.index }}" style="width:100%">
      </div>
    {% endfor %}

    <button class="prev" type="button" aria-label="Previous slide" onclick="plusSlides(-1)">&#10094;</button>
    <button class="next" type="button" aria-label="Next slide" onclick="plusSlides(1)">&#10095;</button>
  </div>
</section>

<script>
  // start on a random slide based on how many were rendered
  let slides = document.getElementsByClassName("slides");
  let slideIndex = slides.length ? Math.floor(Math.random() * slides.length) : 0;
  showSlides(slideIndex);

  function plusSlides(n){ showSlides(slideIndex += n); }

  function showSlides(n){
    if (!slides.length) return;
    if (n >= slides.length) slideIndex = 0;
    if (n < 0) slideIndex = slides.length - 1;
    for (let i = 0; i < slides.length; i++) slides[i].style.display = "none";
    slides[slideIndex].style.display = "block";
  }

  // optional: keyboard navigation
  document.addEventListener("keydown", (e)=>{
    if (e.key === "ArrowRight") plusSlides(1);
    if (e.key === "ArrowLeft")  plusSlides(-1);
  });
</script>
